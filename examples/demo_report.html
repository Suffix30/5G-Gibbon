<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>5G/4G Core Network Security Assessment</title>
    <style>
:root {
    --bg-primary: #0a0a0f;
    --bg-secondary: #12121a;
    --bg-tertiary: #1a1a25;
    --text-primary: #e0e0e8;
    --text-secondary: #a0a0b0;
    --accent-cyan: #00d4ff;
    --accent-magenta: #ff00ff;
    --accent-green: #00ff88;
    --severity-critical: #ff0040;
    --severity-high: #ff4444;
    --severity-medium: #ffaa00;
    --severity-low: #44aaff;
    --severity-info: #888899;
    --border-color: #2a2a3a;
}

* { margin: 0; padding: 0; box-sizing: border-box; }

body {
    font-family: 'JetBrains Mono', 'Fira Code', 'Consolas', monospace;
    background: var(--bg-primary);
    color: var(--text-primary);
    line-height: 1.6;
}

.container {
    max-width: 1400px;
    margin: 0 auto;
    padding: 2rem;
}

header {
    border-bottom: 2px solid var(--accent-cyan);
    padding-bottom: 2rem;
    margin-bottom: 3rem;
    background: linear-gradient(135deg, var(--bg-secondary) 0%, var(--bg-tertiary) 100%);
    padding: 2rem;
    border-radius: 8px;
}

header h1 {
    font-size: 2.5rem;
    background: linear-gradient(90deg, var(--accent-cyan), var(--accent-magenta));
    -webkit-background-clip: text;
    background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    margin-bottom: 0.5rem;
}

header .meta {
    color: var(--text-secondary);
    font-size: 0.9rem;
}

.report-nav {
    display: flex;
    gap: 10px;
    margin-bottom: 1.5rem;
}

.nav-tab {
    padding: 8px 20px;
    background: var(--bg-tertiary);
    border: 1px solid var(--border-color);
    border-radius: 4px;
    color: var(--text-secondary);
    text-decoration: none;
    font-size: 0.9rem;
    transition: all 0.2s;
}

.nav-tab:hover {
    background: var(--bg-secondary);
    color: var(--accent-cyan);
    border-color: var(--accent-cyan);
}

.nav-tab.active {
    background: var(--accent-cyan);
    color: var(--bg-primary);
    border-color: var(--accent-cyan);
    font-weight: bold;
}

.section {
    background: var(--bg-secondary);
    border: 1px solid var(--border-color);
    border-radius: 8px;
    padding: 1.5rem;
    margin-bottom: 2rem;
}

.section h2 {
    color: var(--accent-cyan);
    border-bottom: 1px solid var(--border-color);
    padding-bottom: 0.5rem;
    margin-bottom: 1rem;
    font-size: 1.3rem;
}

.summary-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 1rem;
    margin-bottom: 1.5rem;
}

.summary-card {
    background: var(--bg-tertiary);
    border-radius: 6px;
    padding: 1rem;
    text-align: center;
    border-left: 3px solid var(--accent-cyan);
}

.summary-card.critical { border-left-color: var(--severity-critical); }
.summary-card.high { border-left-color: var(--severity-high); }
.summary-card.medium { border-left-color: var(--severity-medium); }
.summary-card.low { border-left-color: var(--severity-low); }

.summary-card.clickable {
    cursor: pointer;
    transition: all 0.2s ease;
}

.summary-card.clickable:hover {
    transform: translateY(-3px);
    box-shadow: 0 5px 20px rgba(0, 212, 255, 0.3);
}

.summary-card.clickable:active {
    transform: translateY(0);
}

.report-actions {
    position: fixed;
    top: 20px;
    right: 20px;
    display: flex;
    gap: 0.5rem;
    z-index: 1000;
    background: rgba(10, 10, 15, 0.95);
    padding: 10px 15px;
    border-radius: 8px;
    border: 1px solid var(--border-color);
    box-shadow: 0 5px 20px rgba(0, 0, 0, 0.5);
}

.export-btn {
    background: linear-gradient(135deg, var(--bg-tertiary) 0%, var(--bg-secondary) 100%);
    border: 1px solid var(--accent-cyan);
    color: var(--accent-cyan);
    padding: 0.5rem 1rem;
    border-radius: 6px;
    cursor: pointer;
    font-family: 'JetBrains Mono', monospace;
    font-size: 0.8rem;
    transition: all 0.2s ease;
    display: flex;
    align-items: center;
    gap: 6px;
}

.export-btn:hover {
    background: var(--accent-cyan);
    color: var(--bg-primary);
    box-shadow: 0 0 15px rgba(0, 212, 255, 0.4);
}

@media print {
    .report-actions { display: none; }
}

.finding-card.highlight {
    animation: highlightPulse 2s ease-out;
    box-shadow: 0 0 20px rgba(0, 212, 255, 0.5);
}

@keyframes highlightPulse {
    0% { box-shadow: 0 0 30px rgba(0, 212, 255, 0.8); }
    100% { box-shadow: none; }
}

.filter-bar {
    display: flex;
    gap: 0.5rem;
    margin-bottom: 1rem;
    flex-wrap: wrap;
}

.filter-btn {
    background: var(--bg-tertiary);
    border: 1px solid var(--border-color);
    color: var(--text-secondary);
    padding: 0.4rem 1rem;
    border-radius: 20px;
    cursor: pointer;
    font-size: 0.8rem;
    transition: all 0.2s ease;
}

.filter-btn:hover, .filter-btn.active {
    background: var(--accent-cyan);
    color: var(--bg-primary);
    border-color: var(--accent-cyan);
}

.filter-btn.critical:hover, .filter-btn.critical.active { background: var(--severity-critical); border-color: var(--severity-critical); }
.filter-btn.high:hover, .filter-btn.high.active { background: var(--severity-high); border-color: var(--severity-high); }
.filter-btn.medium:hover, .filter-btn.medium.active { background: var(--severity-medium); border-color: var(--severity-medium); }
.filter-btn.low:hover, .filter-btn.low.active { background: var(--severity-low); border-color: var(--severity-low); }

.finding-card.hidden {
    display: none;
}

.summary-card .number {
    font-size: 2rem;
    font-weight: bold;
    color: var(--accent-green);
}

.summary-card .label {
    color: var(--text-secondary);
    font-size: 0.85rem;
}

.finding {
    background: var(--bg-tertiary);
    border-radius: 6px;
    padding: 1rem;
    margin-bottom: 1rem;
    border-left: 4px solid var(--severity-info);
}

.finding.critical { border-left-color: var(--severity-critical); }
.finding.high { border-left-color: var(--severity-high); }
.finding.medium { border-left-color: var(--severity-medium); }
.finding.low { border-left-color: var(--severity-low); }

.finding h3 {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 0.5rem;
}

.finding h3 .title { color: var(--text-primary); }

.severity-badge {
    padding: 0.25rem 0.75rem;
    border-radius: 4px;
    font-size: 0.75rem;
    font-weight: bold;
    text-transform: uppercase;
}

.severity-badge.critical { background: var(--severity-critical); color: white; }
.severity-badge.high { background: var(--severity-high); color: white; }
.severity-badge.medium { background: var(--severity-medium); color: black; }
.severity-badge.low { background: var(--severity-low); color: white; }
.severity-badge.info { background: var(--severity-info); color: white; }

.finding .description { color: var(--text-secondary); margin-bottom: 0.5rem; }
.finding .component { color: var(--accent-cyan); font-size: 0.85rem; }

.evidence {
    background: var(--bg-primary);
    padding: 0.75rem;
    border-radius: 4px;
    margin-top: 0.5rem;
    font-family: monospace;
    font-size: 0.85rem;
    overflow-x: auto;
    border: 1px solid var(--border-color);
}

.remediation {
    background: rgba(0, 255, 136, 0.1);
    border: 1px solid var(--accent-green);
    padding: 0.75rem;
    border-radius: 4px;
    margin-top: 0.5rem;
}

.remediation::before {
    content: "Remediation: ";
    color: var(--accent-green);
    font-weight: bold;
}

table {
    width: 100%;
    border-collapse: collapse;
}

th, td {
    padding: 0.75rem;
    text-align: left;
    border-bottom: 1px solid var(--border-color);
}

th {
    background: var(--bg-tertiary);
    color: var(--accent-cyan);
}

tr:hover { background: var(--bg-tertiary); }

.status-open { color: var(--accent-green); }
.status-closed { color: var(--severity-critical); }
.status-filtered { color: var(--severity-medium); }

.attack-result {
    background: var(--bg-tertiary);
    border-radius: 6px;
    padding: 1rem;
    margin-bottom: 1rem;
}

.attack-result.success { border-left: 4px solid var(--accent-green); }
.attack-result.failed { border-left: 4px solid var(--severity-critical); }

.attack-log {
    margin-top: 1rem;
    padding-top: 1rem;
    border-top: 1px solid var(--border-color);
}

.attack-log h4 {
    color: var(--severity-critical);
    margin-bottom: 1rem;
}

.attack-event {
    background: rgba(0, 0, 0, 0.2);
    padding: 0.8rem;
    margin-bottom: 0.8rem;
    border-radius: 0 4px 4px 0;
}

.event-header {
    display: flex;
    justify-content: space-between;
    margin-bottom: 0.5rem;
}

.event-phase {
    font-weight: bold;
    text-transform: uppercase;
    font-size: 0.75rem;
}

.event-time {
    color: var(--text-secondary);
    font-size: 0.75rem;
}

.event-technique {
    color: var(--text-primary);
    margin-bottom: 0.5rem;
}

.event-command code {
    background: var(--bg-primary);
    padding: 0.3rem 0.5rem;
    border-radius: 4px;
    font-size: 0.8rem;
    color: var(--accent-green);
    display: block;
    overflow-x: auto;
}

.event-payload pre, .event-response pre {
    background: var(--bg-primary);
    padding: 0.5rem;
    border-radius: 4px;
    font-size: 0.75rem;
    overflow-x: auto;
    max-height: 60px;
    margin: 0.3rem 0;
}

.event-payload pre { color: var(--severity-medium); }
.event-response pre { color: var(--text-secondary); }

.event-status {
    font-size: 0.7rem;
    font-weight: bold;
    margin-top: 0.5rem;
}

.event-success { color: var(--accent-green); }
.event-failed { color: var(--severity-critical); }

.event-evidence {
    font-size: 0.75rem;
    color: var(--text-secondary);
    margin-top: 0.3rem;
}

.chart-container {
    background: var(--bg-tertiary);
    border-radius: 6px;
    padding: 1rem;
    margin: 1rem 0;
}

footer {
    text-align: center;
    padding: 2rem;
    color: var(--text-secondary);
    border-top: 1px solid var(--border-color);
    margin-top: 2rem;
}

@media print {
    * {
        -webkit-print-color-adjust: exact !important;
        print-color-adjust: exact !important;
        box-sizing: border-box !important;
    }
    
    @page {
        size: A4 portrait;
        margin: 10mm;
    }
    
    html, body {
        width: 100% !important;
        height: auto !important;
        margin: 0 !important;
        padding: 0 !important;
        background: white !important;
        color: #1a1a1a !important;
        font-size: 9pt !important;
        line-height: 1.3 !important;
        overflow: visible !important;
    }
    
    .container {
        max-width: 100% !important;
        width: 100% !important;
        padding: 0 !important;
        margin: 0 !important;
    }
    
    .report-actions, .filter-bar, .export-btn, .chart-container, canvas {
        display: none !important;
    }
    
    header {
        background: #2a2a35 !important;
        color: white !important;
        padding: 10px !important;
        margin-bottom: 10px !important;
        page-break-after: avoid;
        page-break-inside: avoid;
    }
    
    header h1 {
        font-size: 16pt !important;
        margin: 0 0 5px 0 !important;
    }
    
    header p {
        font-size: 8pt !important;
        margin: 2px 0 !important;
    }
    
    .section {
        background: white !important;
        border: 1px solid #ccc !important;
        border-radius: 0 !important;
        padding: 8px !important;
        margin-bottom: 8px !important;
        page-break-inside: auto !important;
        page-break-before: auto !important;
        overflow: visible !important;
    }
    
    h2 {
        color: #1a1a1a !important;
        border-bottom: 1px solid #00a0c0 !important;
        padding-bottom: 3px !important;
        margin: 0 0 8px 0 !important;
        font-size: 12pt !important;
        page-break-after: avoid !important;
        page-break-inside: avoid !important;
    }
    
    .summary-grid {
        display: flex !important;
        flex-wrap: wrap !important;
        gap: 5px !important;
        margin-bottom: 10px !important;
    }
    
    .summary-card {
        background: white !important;
        border: 1px solid #ccc !important;
        padding: 5px 10px !important;
        text-align: center !important;
        flex: 1 1 80px !important;
        min-width: 60px !important;
    }
    
    .summary-card .number {
        font-size: 14pt !important;
        font-weight: bold !important;
        color: #1a1a1a !important;
    }
    
    .summary-card .label {
        font-size: 7pt !important;
        color: #666 !important;
    }
    
    .summary-card.critical { border-left: 3px solid #ff0040 !important; }
    .summary-card.high { border-left: 3px solid #ff4444 !important; }
    .summary-card.medium { border-left: 3px solid #cc8800 !important; }
    .summary-card.low { border-left: 3px solid #0088cc !important; }
    
    .finding, .finding-card {
        background: white !important;
        border: 1px solid #ddd !important;
        border-left: 3px solid #666 !important;
        padding: 6px !important;
        margin-bottom: 6px !important;
        page-break-inside: avoid !important;
        break-inside: avoid !important;
    }
    
    .finding.critical, .finding-card.critical { border-left-color: #ff0040 !important; }
    .finding.high, .finding-card.high { border-left-color: #ff4444 !important; }
    .finding.medium, .finding-card.medium { border-left-color: #cc8800 !important; }
    .finding.low, .finding-card.low { border-left-color: #0088cc !important; }
    
    .finding h3, .finding-card h3 {
        font-size: 10pt !important;
        margin: 0 0 4px 0 !important;
    }
    
    .finding p, .finding-card p {
        font-size: 8pt !important;
        margin: 2px 0 !important;
    }
    
    .severity-badge {
        padding: 1px 5px !important;
        border-radius: 2px !important;
        font-size: 7pt !important;
        font-weight: bold !important;
    }
    
    .severity-badge.critical { background: #ff0040 !important; color: white !important; }
    .severity-badge.high { background: #ff4444 !important; color: white !important; }
    .severity-badge.medium { background: #cc8800 !important; color: white !important; }
    .severity-badge.low { background: #0088cc !important; color: white !important; }
    
    table {
        width: 100% !important;
        border-collapse: collapse !important;
        font-size: 8pt !important;
        page-break-inside: auto;
    }
    
    th, td {
        border: 1px solid #ccc !important;
        padding: 4px !important;
        text-align: left !important;
        background: white !important;
        color: #1a1a1a !important;
        word-wrap: break-word !important;
        max-width: 150px !important;
    }
    
    th {
        background: #e8e8e8 !important;
        font-weight: bold !important;
    }
    
    .attack-result {
        background: white !important;
        border: 1px solid #ccc !important;
        padding: 6px !important;
        margin-bottom: 6px !important;
        page-break-inside: auto !important;
    }
    
    .attack-result h3 {
        font-size: 10pt !important;
        margin: 0 0 4px 0 !important;
        page-break-after: avoid !important;
    }
    
    .attack-result > ul {
        page-break-before: avoid !important;
    }
    
    .attack-log {
        background: #f5f5f5 !important;
        border: 1px solid #ddd !important;
        padding: 6px !important;
        margin-top: 6px !important;
        page-break-inside: auto !important;
    }
    
    .attack-log h4 {
        font-size: 9pt !important;
        margin: 0 0 4px 0 !important;
        page-break-after: avoid !important;
    }
    
    .attack-event {
        background: white !important;
        border: 1px solid #eee !important;
        border-left: 2px solid #666 !important;
        padding: 4px !important;
        margin-bottom: 4px !important;
        page-break-inside: avoid !important;
        font-size: 7pt !important;
    }
    
    .event-header {
        font-size: 7pt !important;
    }
    
    .event-technique {
        font-size: 8pt !important;
    }
    
    .event-command code {
        display: block !important;
        background: #f0f0f0 !important;
        color: #1a1a1a !important;
        padding: 3px !important;
        font-size: 7pt !important;
        word-wrap: break-word !important;
        white-space: pre-wrap !important;
    }
    
    .event-payload pre, .event-response pre {
        background: #f0f0f0 !important;
        color: #1a1a1a !important;
        padding: 3px !important;
        font-size: 6pt !important;
        max-height: none !important;
        word-wrap: break-word !important;
        white-space: pre-wrap !important;
        overflow: visible !important;
    }
    
    pre, code {
        white-space: pre-wrap !important;
        word-wrap: break-word !important;
        overflow: visible !important;
    }
    
    footer {
        margin-top: 10px !important;
        padding-top: 5px !important;
        border-top: 1px solid #ccc !important;
        font-size: 7pt !important;
        color: #666 !important;
        page-break-before: avoid;
    }
    
    a { color: #0066cc !important; text-decoration: none !important; }
    
    .hidden { display: none !important; }
    
    ul { 
        padding-left: 15px !important; 
        margin: 4px 0 !important;
    }
    
    li {
        font-size: 8pt !important;
        margin: 2px 0 !important;
    }
}
</style>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <div class="container">
        
<header>
    <div class="report-nav">
        <a href="demo_report.html" class="nav-tab active">Document View</a>
        <a href="demo_topology.html" class="nav-tab">Topology View</a>
        <a href="demo_report.json" class="nav-tab" download>JSON Export</a>
    </div>
    <h1>5G/4G Core Network Security Assessment</h1>
    <div class="meta">
        <p><strong>Assessment Type:</strong> Penetration Test</p>
        <p><strong>Target Network:</strong> 10.0.0.0/24</p>
        <p><strong>Period:</strong> 2025-12-28 18:00:00 - 2025-12-28 19:30:00</p>
        <p><strong>Generated by:</strong> 5G-Gibbon Toolkit v1.0.0</p>
    </div>
</header>
        
<div class="report-actions">
    <button onclick="exportReport('pdf')" class="export-btn">PDF</button>
    <button onclick="exportReport('html')" class="export-btn">Save</button>
    <button onclick="window.print()" class="export-btn">Print</button>
</div>
<div class="section">
    <h2>Executive Summary</h2>
    <div class="summary-grid">
        <div class="summary-card critical clickable" onclick="navigateToSeverity('critical')" data-severity="critical">
            <div class="number">3</div>
            <div class="label">Critical</div>
        </div>
        <div class="summary-card high clickable" onclick="navigateToSeverity('high')" data-severity="high">
            <div class="number">1</div>
            <div class="label">High</div>
        </div>
        <div class="summary-card medium clickable" onclick="navigateToSeverity('medium')" data-severity="medium">
            <div class="number">0</div>
            <div class="label">Medium</div>
        </div>
        <div class="summary-card low clickable" onclick="navigateToSeverity('low')" data-severity="low">
            <div class="number">0</div>
            <div class="label">Low</div>
        </div>
        <div class="summary-card clickable" onclick="navigateToSection('scan-results')">
            <div class="number">3</div>
            <div class="label">Scans</div>
        </div>
        <div class="summary-card clickable" onclick="navigateToSection('attack-results')">
            <div class="number">3/3</div>
            <div class="label">Successful Attacks</div>
        </div>
    </div>
    <div class="chart-container">
        <canvas id="severityChart" width="400" height="200"></canvas>
    </div>
</div>
        
<div class="section" id="findings-section">
    <h2>Security Findings (4)</h2>
    <div class="filter-bar">
        <button class="filter-btn active" onclick="filterFindings('all')">All</button>
        <button class="filter-btn critical" onclick="filterFindings('critical')">Critical</button>
        <button class="filter-btn high" onclick="filterFindings('high')">High</button>
        <button class="filter-btn medium" onclick="filterFindings('medium')">Medium</button>
        <button class="filter-btn low" onclick="filterFindings('low')">Low</button>
    </div>
    
<div class="finding finding-card critical" id="finding-0" data-severity="critical">
    <h3>
        <span class="title">Nested Tunnel Injection</span>
        <span class="severity-badge critical">critical</span>
    </h3>
    <p class="description">Inner GTP tunnel not validated, allowing billing fraud</p>
    <p class="component">Affected: UPF (10.0.0.10)</p>
    <div class="evidence">Malicious data injected via nested tunnel</div>
    <div class="remediation">Validate inner tunnel TEIDs, implement DPI</div>
</div>
<div class="finding finding-card critical" id="finding-1" data-severity="critical">
    <h3>
        <span class="title">MongoDB Exposed Without Authentication</span>
        <span class="severity-badge critical">critical</span>
    </h3>
    <p class="description">MongoDB accessible without credentials, subscriber keys extracted</p>
    <p class="component">Affected: NRF/UDM (10.0.0.30)</p>
    <div class="evidence">156 subscriber K/OPc keys extracted</div>
    <div class="remediation">Enable MongoDB authentication, restrict network access</div>
</div>
<div class="finding finding-card critical" id="finding-2" data-severity="critical">
    <h3>
        <span class="title">Rogue eNodeB Acceptance</span>
        <span class="severity-badge critical">critical</span>
    </h3>
    <p class="description">MME accepts S1 connections without certificate validation</p>
    <p class="component">Affected: MME (10.0.0.40)</p>
    <div class="evidence">Rogue eNodeB registered successfully</div>
    <div class="remediation">Implement mutual TLS for S1 interface</div>
</div>
<div class="finding finding-card high" id="finding-3" data-severity="high">
    <h3>
        <span class="title">TEID Enumeration Possible</span>
        <span class="severity-badge high">high</span>
    </h3>
    <p class="description">UPF responds to GTP-U echo requests with sequential TEIDs</p>
    <p class="component">Affected: UPF (10.0.0.10)</p>
    <div class="evidence">156 active TEIDs discovered via brute force</div>
    <div class="remediation">Implement TEID randomization and rate limiting</div>
</div>
</div>
        
<div class="section" id="scan-results">
    <h2>Scan Results (3)</h2>
    <table>
        <thead>
            <tr>
                <th>Target</th>
                <th>Port</th>
                <th>Service</th>
                <th>State</th>
                <th>Banner</th>
                <th>Vulnerabilities</th>
            </tr>
        </thead>
        <tbody>
            
<tr>
    <td>10.0.0.10</td>
    <td>2152</td>
    <td>GTP-U</td>
    <td class="status-open">open</td>
    <td>GTP-U User Plane</td>
    <td>No rate limiting</td>
</tr>
<tr>
    <td>10.0.0.30</td>
    <td>27017</td>
    <td>MongoDB</td>
    <td class="status-open">open</td>
    <td>MongoDB 4.4</td>
    <td>No authentication, Exposed to network</td>
</tr>
<tr>
    <td>10.0.0.40</td>
    <td>36412</td>
    <td>S1AP</td>
    <td class="status-open">open</td>
    <td>MME S1 Interface</td>
    <td>No certificate validation</td>
</tr>
        </tbody>
    </table>
</div>
        
<div class="section" id="attack-results">
    <h2>Attack Results (3)</h2>
    
<div class="attack-result success">
    <h3>UPF TEID Enumeration & Billing Fraud - <span class="success">Success</span></h3>
    <p><strong>Target:</strong> 10.0.0.10</p>
    <p><strong>Time:</strong> 2025-12-28 18:00:01 (Duration: 152.50s)</p>
    <ul><li><strong>TEIDs discovered:</strong> 156</li><li><strong>Billing bypass:</strong> Successful</li><li><strong>Data injected:</strong> 1024 bytes</li></ul>
    <div class="attack-log"><h4>Attack Log</h4>
                    <div class="attack-event" style="border-left: 3px solid #00d4ff;">
                        <div class="event-header">
                            <span class="event-phase" style="color: #00d4ff;">Reconnaissance</span>
                            <span class="event-time">2025-12-28 18:00:01</span>
                        </div>
                        <div class="event-technique">Port Scan</div>
                        <div class="event-command"><code>nmap -sU -p 2152 10.0.0.10</code></div>
                        
                        <div class="event-response"><strong>Response:</strong> <pre>2152/udp open gtp-u</pre></div>
                        <div class="event-status event-success">SUCCESS</div>
                        <div class="event-evidence"><strong>Evidence:</strong> ports_found: [2152]</div>
                    </div>
                    <div class="attack-event" style="border-left: 3px solid #ffaa00;">
                        <div class="event-header">
                            <span class="event-phase" style="color: #ffaa00;">Enumeration</span>
                            <span class="event-time">2025-12-28 18:00:15</span>
                        </div>
                        <div class="event-technique">TEID Brute Force</div>
                        <div class="event-command"><code>python run.py enumerate teid --target 10.0.0.10 --start 0 --end 10000</code></div>
                        <div class="event-payload"><strong>Payload:</strong> <pre>GTP-U Echo Request with TEID=0x00000001-0x00002710</pre></div>
                        <div class="event-response"><strong>Response:</strong> <pre>Found 156 active TEIDs: 0x00000100, 0x00000101, ...</pre></div>
                        <div class="event-status event-success">SUCCESS</div>
                        <div class="event-evidence"><strong>Evidence:</strong> active_teids: 156</div>
                    </div>
                    <div class="attack-event" style="border-left: 3px solid #ff0040;">
                        <div class="event-header">
                            <span class="event-phase" style="color: #ff0040;">Exploitation</span>
                            <span class="event-time">2025-12-28 18:02:30</span>
                        </div>
                        <div class="event-technique">Nested Tunnel Injection</div>
                        <div class="event-command"><code>python run.py attack billing --upf 10.0.0.10 --teid 256</code></div>
                        <div class="event-payload"><strong>Payload:</strong> <pre>IP/UDP/GTP/IP/UDP/malicious_data</pre></div>
                        <div class="event-response"><strong>Response:</strong> <pre>Packet accepted, no inner TEID validation</pre></div>
                        <div class="event-status event-success">SUCCESS</div>
                        <div class="event-evidence"><strong>Evidence:</strong> billing_bypass: True, bytes_injected: 1024</div>
                    </div></div>
</div>
<div class="attack-result success">
    <h3>MongoDB Key Extraction - <span class="success">Success</span></h3>
    <p><strong>Target:</strong> 10.0.0.30</p>
    <p><strong>Time:</strong> 2025-12-28 18:05:00 (Duration: 78.20s)</p>
    <ul><li><strong>Database accessed:</strong> open5gs</li><li><strong>Collections:</strong> subscribers</li><li><strong>Keys extracted:</strong> 156</li></ul>
    <div class="attack-log"><h4>Attack Log</h4>
                    <div class="attack-event" style="border-left: 3px solid #00d4ff;">
                        <div class="event-header">
                            <span class="event-phase" style="color: #00d4ff;">Reconnaissance</span>
                            <span class="event-time">2025-12-28 18:05:00</span>
                        </div>
                        <div class="event-technique">Service Discovery</div>
                        <div class="event-command"><code>curl http://10.0.0.30:80/nnrf-disc/v1/nf-instances</code></div>
                        
                        <div class="event-response"><strong>Response:</strong> <pre>{"nfInstances": [{"nfType": "AMF"}, ...]}</pre></div>
                        <div class="event-status event-success">SUCCESS</div>
                        
                    </div>
                    <div class="attack-event" style="border-left: 3px solid #ff00ff;">
                        <div class="event-header">
                            <span class="event-phase" style="color: #ff00ff;">Exfiltration</span>
                            <span class="event-time">2025-12-28 18:06:00</span>
                        </div>
                        <div class="event-technique">Key Extraction</div>
                        <div class="event-command"><code>mongosh open5gs --eval "db.subscribers.find()"</code></div>
                        <div class="event-payload"><strong>Payload:</strong> <pre>db.subscribers.find({})</pre></div>
                        <div class="event-response"><strong>Response:</strong> <pre>156 subscriber records with K/OPc keys</pre></div>
                        <div class="event-status event-success">SUCCESS</div>
                        <div class="event-evidence"><strong>Evidence:</strong> keys_extracted: 156</div>
                    </div></div>
</div>
<div class="attack-result success">
    <h3>4G Rogue eNodeB Attack - <span class="success">Success</span></h3>
    <p><strong>Target:</strong> 10.0.0.40</p>
    <p><strong>Time:</strong> 2025-12-28 18:10:00 (Duration: 120.00s)</p>
    <ul><li><strong>MME accepted rogue eNB:</strong> True</li><li><strong>Certificate validation:</strong> None</li><li><strong>HSS accessed:</strong> True</li></ul>
    <div class="attack-log"><h4>Attack Log</h4>
                    <div class="attack-event" style="border-left: 3px solid #00d4ff;">
                        <div class="event-header">
                            <span class="event-phase" style="color: #00d4ff;">Reconnaissance</span>
                            <span class="event-time">2025-12-28 18:10:00</span>
                        </div>
                        <div class="event-technique">S1AP Port Scan</div>
                        <div class="event-command"><code>nmap -sS -p 36412 10.0.0.40</code></div>
                        
                        <div class="event-response"><strong>Response:</strong> <pre>36412/tcp open s1ap</pre></div>
                        <div class="event-status event-success">SUCCESS</div>
                        
                    </div>
                    <div class="attack-event" style="border-left: 3px solid #ff0040;">
                        <div class="event-header">
                            <span class="event-phase" style="color: #ff0040;">Exploitation</span>
                            <span class="event-time">2025-12-28 18:10:30</span>
                        </div>
                        <div class="event-technique">Rogue eNodeB</div>
                        <div class="event-command"><code>python run.py lte rogue-enb --mme 10.0.0.40</code></div>
                        <div class="event-payload"><strong>Payload:</strong> <pre>S1SetupRequest(global_enb_id=0x12345)</pre></div>
                        <div class="event-response"><strong>Response:</strong> <pre>S1SetupResponse accepted</pre></div>
                        <div class="event-status event-success">SUCCESS</div>
                        <div class="event-evidence"><strong>Evidence:</strong> mme_accepted: True</div>
                    </div>
                    <div class="attack-event" style="border-left: 3px solid #ff6600;">
                        <div class="event-header">
                            <span class="event-phase" style="color: #ff6600;">Lateral Movement</span>
                            <span class="event-time">2025-12-28 18:11:00</span>
                        </div>
                        <div class="event-technique">HSS Query</div>
                        <div class="event-command"><code>python run.py lte hss-probe --hss 10.0.0.50</code></div>
                        <div class="event-payload"><strong>Payload:</strong> <pre>AIR(imsi="001010123456789")</pre></div>
                        <div class="event-response"><strong>Response:</strong> <pre>Auth vectors obtained</pre></div>
                        <div class="event-status event-success">SUCCESS</div>
                        <div class="event-evidence"><strong>Evidence:</strong> auth_vectors: 5</div>
                    </div></div>
</div>
</div>
        
<div class="section">
    <h2>General Recommendations</h2>
    <ul><li>Implement network segmentation between 5G core components</li><li>Enable mutual TLS for all SBI interfaces</li><li>Deploy rate limiting on GTP-U and PFCP interfaces</li><li>Enable logging and monitoring on all 5G network functions</li><li>Implement TEID/SEID randomization to prevent enumeration</li><li>Deploy DPI solutions for GTP tunnel inspection</li><li>Regular security assessments using 5G-specific tools</li></ul>
</div>
        
<footer>
    <p>Generated by 5G-Gibbon Security Toolkit</p>
    <p>Report generated on 2025-12-28 19:40:02</p>
</footer>
    </div>
    
<script>
const ctx = document.getElementById('severityChart').getContext('2d');
const severityLabels = ['critical', 'high', 'medium', 'low', 'info'];
const chart = new Chart(ctx, {
    type: 'doughnut',
    data: {
        labels: ['Critical', 'High', 'Medium', 'Low', 'Info'],
        datasets: [{
            data: [3, 1, 0, 0, 0],
            backgroundColor: ['#ff0040', '#ff4444', '#ffaa00', '#44aaff', '#888899'],
            borderColor: '#1a1a25',
            borderWidth: 2
        }]
    },
    options: {
        responsive: true,
        onClick: (e, elements) => {
            if (elements.length > 0) {
                const index = elements[0].index;
                navigateToSeverity(severityLabels[index]);
            }
        },
        plugins: {
            legend: {
                position: 'right',
                labels: { color: '#e0e0e8' },
                onClick: (e, legendItem, legend) => {
                    navigateToSeverity(severityLabels[legendItem.index]);
                }
            }
        }
    }
});

function navigateToSeverity(severity) {
    const section = document.getElementById('findings-section');
    if (section) {
        section.scrollIntoView({ behavior: 'smooth' });
        filterFindings(severity);
        
        document.querySelectorAll('.finding-card[data-severity="' + severity + '"]').forEach((el, i) => {
            if (i === 0) {
                setTimeout(() => {
                    el.classList.add('highlight');
                    setTimeout(() => el.classList.remove('highlight'), 2000);
                }, 500);
            }
        });
    }
}

function navigateToSection(sectionId) {
    const section = document.getElementById(sectionId);
    if (section) {
        section.scrollIntoView({ behavior: 'smooth' });
        section.classList.add('highlight');
        setTimeout(() => section.classList.remove('highlight'), 2000);
    }
}

function filterFindings(severity) {
    document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active'));
    
    if (severity === 'all') {
        document.querySelector('.filter-btn:first-child').classList.add('active');
        document.querySelectorAll('.finding-card').forEach(el => el.classList.remove('hidden'));
    } else {
        document.querySelector('.filter-btn.' + severity).classList.add('active');
        document.querySelectorAll('.finding-card').forEach(el => {
            if (el.dataset.severity === severity) {
                el.classList.remove('hidden');
            } else {
                el.classList.add('hidden');
            }
        });
    }
}

function exportReport(format) {
    if (format === 'pdf') {
        window.print();
    } else if (format === 'html') {
        const blob = new Blob([document.documentElement.outerHTML], { type: 'text/html' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = 'security_report_' + new Date().toISOString().split('T')[0] + '.html';
        a.click();
        URL.revokeObjectURL(url);
    }
}
</script>
</body>
</html>